2025-04-15 22:03:21,734 - DEBUG - Using selector: KqueueSelector
2025-04-15 22:03:21,734 - DEBUG - Running cli.py from: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/app/cli.py
2025-04-15 22:03:21,735 - DEBUG - os module loaded: <module 'os' (frozen)>
2025-04-15 22:03:21,738 - DEBUG - Validating files: tests/test_data/platform-ui.json, submission.zip, tests/test_data/spec.txt, tests/test_data/scorecard.json
2025-04-15 22:03:21,738 - ERROR - File not found: submission.zip
2025-04-15 22:03:21,738 - ERROR - File validation failed
2025-04-15 22:03:33,000 - DEBUG - Using selector: KqueueSelector
2025-04-15 22:03:33,001 - DEBUG - Running cli.py from: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/app/cli.py
2025-04-15 22:03:33,001 - DEBUG - os module loaded: <module 'os' (frozen)>
2025-04-15 22:03:33,003 - DEBUG - Validating files: tests/test_data/platform-ui.json, tests/test_data/submission.zip, tests/test_data/spec.txt, tests/test_data/scorecard.json
2025-04-15 22:03:33,003 - DEBUG - Initializing MasterAgent with model_name=parallel, backend=bedrock, tech_stack=['TypeScript', ' Python']
2025-04-15 22:03:33,003 - DEBUG - Normalized 'TypeScript' to 'TypeScript'
2025-04-15 22:03:33,003 - DEBUG - Normalized 'TypeScript' to 'TypeScript'
2025-04-15 22:03:33,003 - DEBUG - Normalized 'Python' to 'Python'
2025-04-15 22:03:33,003 - DEBUG - Normalized 'Python' to 'Python'
2025-04-15 22:03:33,004 - DEBUG - Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2025-04-15 22:03:33,009 - DEBUG - Changing event name from before-call.apigateway to before-call.api-gateway
2025-04-15 22:03:33,011 - DEBUG - Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2025-04-15 22:03:33,013 - DEBUG - Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2025-04-15 22:03:33,013 - DEBUG - Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2025-04-15 22:03:33,020 - DEBUG - Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2025-04-15 22:03:33,021 - DEBUG - Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2025-04-15 22:03:33,029 - DEBUG - Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2025-04-15 22:03:33,029 - DEBUG - Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2025-04-15 22:03:33,030 - DEBUG - Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2025-04-15 22:03:33,031 - DEBUG - Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2025-04-15 22:03:33,049 - DEBUG - IMDS ENDPOINT: http://169.254.169.254/
2025-04-15 22:03:33,065 - DEBUG - Looking for credentials via: env
2025-04-15 22:03:33,065 - DEBUG - Looking for credentials via: assume-role
2025-04-15 22:03:33,065 - DEBUG - Looking for credentials via: assume-role-with-web-identity
2025-04-15 22:03:33,066 - DEBUG - Looking for credentials via: sso
2025-04-15 22:03:33,066 - DEBUG - Looking for credentials via: shared-credentials-file
2025-04-15 22:03:33,067 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2025-04-15 22:03:33,074 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/endpoints.json
2025-04-15 22:03:33,116 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/sdk-default-configuration.json
2025-04-15 22:03:33,117 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x1089f05e0>
2025-04-15 22:03:33,200 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/bedrock-runtime/2023-09-30/service-2.json.gz
2025-04-15 22:03:33,253 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/bedrock-runtime/2023-09-30/endpoint-rule-set-1.json.gz
2025-04-15 22:03:33,254 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/partitions.json
2025-04-15 22:03:33,256 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x1088c53a0>
2025-04-15 22:03:33,256 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-15 22:03:33,256 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-15 22:03:33,256 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-15 22:03:33,256 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-15 22:03:33,257 - DEBUG - No configured endpoint found.
2025-04-15 22:03:33,257 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-15 22:03:33,260 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-15 22:03:33,263 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/_retry.json
2025-04-15 22:03:33,263 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-15 22:03:33,264 - DEBUG - Initialized Bedrock client: model_name=mistral_large, region=us-east-1
2025-04-15 22:03:33,264 - DEBUG - Loading config for model: mistral_large
2025-04-15 22:03:33,273 - DEBUG - Model config for mistral_large: {'model_id': 'mistral.mistral-large-2402-v1:0', 'max_tokens': 256, 'temperature': 0.3, 'top_p': 0.9, 'top_k': 50}
2025-04-15 22:03:33,273 - DEBUG - ValidationAgent initialized with tech_stack=['TypeScript', 'Python'], model_name=mistral_large, model_backend=bedrock
2025-04-15 22:03:33,274 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x1089f05e0>
2025-04-15 22:03:33,275 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x1088c53a0>
2025-04-15 22:03:33,275 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-15 22:03:33,275 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-15 22:03:33,276 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-15 22:03:33,276 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-15 22:03:33,277 - DEBUG - No configured endpoint found.
2025-04-15 22:03:33,278 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-15 22:03:33,280 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-15 22:03:33,282 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-15 22:03:33,283 - DEBUG - Initialized Bedrock client: model_name=mistral_large, region=us-east-1
2025-04-15 22:03:33,283 - DEBUG - Loading config for model: mistral_large
2025-04-15 22:03:33,293 - DEBUG - Model config for mistral_large: {'model_id': 'mistral.mistral-large-2402-v1:0', 'max_tokens': 256, 'temperature': 0.3, 'top_p': 0.9, 'top_k': 50}
2025-04-15 22:03:33,302 - DEBUG - Loaded prompts: dict_keys(['nlp_questions', 'security', 'quality', 'performance'])
2025-04-15 22:03:33,310 - DEBUG - Loaded prompts: dict_keys(['nlp_questions', 'security', 'quality', 'performance'])
2025-04-15 22:03:33,314 - DEBUG - Calling MasterAgent.review_code
2025-04-15 22:03:33,315 - DEBUG - Starting review_code with model_name=parallel, zip_path=tests/test_data/submission.zip
2025-04-15 22:03:33,315 - DEBUG - Validating zip: tests/test_data/submission.zip
2025-04-15 22:03:33,320 - DEBUG - Files in tests/test_data/submission.zip: ['app/core/llm/__init__.py', 'app/core/llm/bedrock_llm.py', 'app/core/llm/manager.py', 'app/core/__init__.py', 'app/core/agents/master_agent.py', 'app/core/agents/__init__.py', 'app/core/agents/validation_agent.py', 'app/core/agents/nlp_question_agent.py', 'app/core/processors/chunk_splitter.py', 'app/core/processors/zip_processor.py', 'app/core/processors/__init__.py', 'app/core/processors/sonar_parser.py', 'app/__init__.py', 'app/cli.py', 'app/static/js/app.js', 'app/templates/index.html', 'app/main.py']
2025-04-15 22:03:33,320 - DEBUG - Detected languages: ['Python', 'HTML', 'JavaScript']
2025-04-15 22:03:33,321 - DEBUG - Expected tech stack: ['TypeScript', 'Python']
2025-04-15 22:03:33,322 - DEBUG - Matching languages: ['Python']
2025-04-15 22:03:33,323 - INFO - Validation passed with matching languages: Python
2025-04-15 22:03:33,343 - DEBUG - Parsed sonar_data: {"issues": [{"key": "ef38b772-1c4c-447f-bc86-18b93a64dfdb", "rule": "css:S4667", "severity": "MAJOR", "component": "platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Story...
2025-04-15 22:03:33,494 - DEBUG - Extracted 2 code chunks
2025-04-15 22:03:33,495 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x1089f05e0>
2025-04-15 22:03:33,495 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x1088c53a0>
2025-04-15 22:03:33,496 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-15 22:03:33,496 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-15 22:03:33,497 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-15 22:03:33,497 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-15 22:03:33,497 - DEBUG - No configured endpoint found.
2025-04-15 22:03:33,497 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-15 22:03:33,500 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-15 22:03:33,503 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-15 22:03:33,504 - DEBUG - Initialized Bedrock client: model_name=mistral_large, region=us-east-1
2025-04-15 22:03:33,504 - DEBUG - Loading config for model: mistral_large
2025-04-15 22:03:33,536 - DEBUG - Model config for mistral_large: {'model_id': 'mistral.mistral-large-2402-v1:0', 'max_tokens': 256, 'temperature': 0.3, 'top_p': 0.9, 'top_k': 50}
2025-04-15 22:03:33,537 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x1089f05e0>
2025-04-15 22:03:33,537 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x1088c53a0>
2025-04-15 22:03:33,538 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-15 22:03:33,538 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-15 22:03:33,538 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-15 22:03:33,538 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-15 22:03:33,538 - DEBUG - No configured endpoint found.
2025-04-15 22:03:33,539 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-15 22:03:33,541 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-15 22:03:33,545 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-15 22:03:33,546 - DEBUG - Initialized Bedrock client: model_name=llama3_70b, region=us-east-1
2025-04-15 22:03:33,546 - DEBUG - Loading config for model: llama3_70b
2025-04-15 22:03:33,553 - DEBUG - Model config for llama3_70b: {'model_id': 'meta.llama3-70b-instruct-v1:0', 'max_tokens': 256, 'temperature': 0.5, 'top_p': 0.9}
2025-04-15 22:03:33,554 - DEBUG - Analyzing security with model_name=mistral_large
2025-04-15 22:03:33,554 - DEBUG - Analyzing quality with model_name=llama3_70b
2025-04-15 22:03:33,554 - DEBUG - Analyzing performance with model_name=mistral_large
2025-04-15 22:03:33,556 - DEBUG - Analysis results - security: 0, quality: {'maintainability_score': 50, 'code_smells': 2, 'doc_coverage': 0}, performance: {'rating': 60, 'bottlenecks': [], 'optimization_suggestions': []}
2025-04-15 22:03:33,556 - DEBUG - Summary updated: {'code_quality': 50, 'security': 100, 'performance': 60, 'total': 6.8}
2025-04-15 22:03:33,557 - DEBUG - Loaded spec: ...
2025-04-15 22:03:33,557 - DEBUG - Processing questions with model_name=mistral_large, question_file=tests/test_data/scorecard.json
2025-04-15 22:03:33,582 - DEBUG - Loaded 4 questions: ['The solution provides a unique approach to solving', 'Requirements are implemented completely according ', 'The technical solution is modern and designed with', 'Complete and easy-to-follow documentation is inclu']
2025-04-15 22:03:33,583 - DEBUG - Processing question: The solution provides a unique approach to solving...
2025-04-15 22:03:33,583 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-15 22:03:33,584 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-15 22:03:33,584 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-15 22:03:33,584 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"line\": 1,\n      \"message\": \"Unexpected em", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.join(os...
2025-04-15 22:03:33,584 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "ef38b772-1c4c-447f-bc86-18b93a64dfdb",
      "rule": "css:S4667",
      "severity": "MAJOR",
      "component": "platform...
2025-04-15 22:03:33,585 - DEBUG - Prompt for 'The solution provides a unique approach to solving...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"lin...
2025-04-15 22:03:33,585 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-15 22:03:33,586 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-15 22:03:33,586 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-15 22:03:33,587 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-15 22:03:33,592 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x1089f0cc0>
2025-04-15 22:03:33,593 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-15 22:03:33,594 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-15 22:03:33,596 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1089f0860>
2025-04-15 22:03:33,596 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_query_compatibility_header at 0x1089f3740>
2025-04-15 22:03:33,596 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1089f27a0>
2025-04-15 22:03:33,596 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"ef38b772-1c4c-447f-bc86-18b93a64dfdb\\",\\n      \\"rule\\": \\"css:S4667\\",\\n      \\"severity\\": \\"MAJOR\\",\\n      \\"component\\": \\"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\\",\\n      \\"line\\": 1,\\n      \\"message\\": \\"Unexpected em\\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: \\nQuestion: [\\n  {{\\n    \\"question\\": \\"The solution provides a unique approach to solving the given problem(s).\\",\\n    \\"category\\": \\"Innovation & Creativity\\",\\n    \\"weight\\": 20.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x108cd3b10>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-15 22:03:33,597 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x108cd3110>>
2025-04-15 22:03:33,598 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x1089f0ae0>
2025-04-15 22:03:33,600 - DEBUG - Calculating signature using v4 auth.
2025-04-15 22:03:33,600 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250415T150333Z

content-type;host;x-amz-date
384d7a62bbccb6a5b3cc8611834e3c90d55a9d4f9d148fee33b8b88fa606acd3
2025-04-15 22:03:33,600 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250415T150333Z
20250415/us-east-1/bedrock/aws4_request
96faccacad0490bb996aa75e45d1ead90b1822e625b20f8ae5f7ce61d35f9671
2025-04-15 22:03:33,601 - DEBUG - Signature:
f718649afcdfe3930e6cf3b322f72dd2688529068fc2eb42902ef65e1da55be4
2025-04-15 22:03:33,601 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1089f2fc0>
2025-04-15 22:03:33,601 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99', 'X-Amz-Date': b'20250415T150333Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250415/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=f718649afcdfe3930e6cf3b322f72dd2688529068fc2eb42902ef65e1da55be4', 'amz-sdk-invocation-id': b'6da38587-050b-4da6-92f8-6b75303a03b0', 'amz-sdk-request': b'attempt=1', 'Content-Length': '1707'}>
2025-04-15 22:03:33,603 - DEBUG - Starting new HTTPS connection (1): bedrock-runtime.us-east-1.amazonaws.com:443
2025-04-15 22:03:35,602 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 248
2025-04-15 22:03:35,619 - DEBUG - Response headers: {'Date': 'Tue, 15 Apr 2025 15:03:35 GMT', 'Content-Type': 'application/json', 'Content-Length': '248', 'Connection': 'keep-alive', 'x-amzn-RequestId': 'cbcc1378-950f-4e73-8a74-1b2f7afd1cbb', 'X-Amzn-Bedrock-Invocation-Latency': '977', 'X-Amzn-Bedrock-Output-Token-Count': '44', 'X-Amzn-Bedrock-Input-Token-Count': '537'}
2025-04-15 22:03:35,619 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x1084d7a60>
2025-04-15 22:03:35,620 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x109bcce10>
2025-04-15 22:03:35,620 - DEBUG - No retry needed.
2025-04-15 22:03:35,620 - DEBUG - Bedrock response status: 200
2025-04-15 22:03:35,631 - DEBUG - Raw response: {"outputs": [{"text": "{\"answer\": \"The provided code does not show a unique approach to solving the problem. It is a standard Python script with logging and argument parsing. No innovation is evident.\", \"confidence\": 4}", "stop_reason": "stop"}]}...
2025-04-15 22:03:35,632 - DEBUG - NLP raw response for 'The solution provides a unique approach to solving...': {"answer": "The provided code does not show a unique approach to solving the problem. It is a standard Python script with logging and argument parsing. No innovation is evident.", "confidence": 4}...
2025-04-15 22:03:35,633 - DEBUG - Parsed JSON: [{'answer': 'The provided code does not show a unique approach to solving the problem. It is a standard Python script with logging and argument parsing. No innovation is evident.', 'confidence': 4}]
2025-04-15 22:03:35,633 - DEBUG - Generated answer: {'question': 'The solution provides a unique approach to solving the given problem(s).', 'category': 'Innovation & Creativity', 'answer': 'The provided code does not show a unique approach to solving the problem. It is a standard Python script with logging and argument parsing. No innovation is evident.', 'confidence': 4, 'weight': 20.0}
2025-04-15 22:03:35,633 - DEBUG - Processing question: Requirements are implemented completely according ...
2025-04-15 22:03:35,633 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-15 22:03:35,634 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-15 22:03:35,634 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-15 22:03:35,634 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"line\": 1,\n      \"message\": \"Unexpected em", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.join(os...
2025-04-15 22:03:35,634 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "ef38b772-1c4c-447f-bc86-18b93a64dfdb",
      "rule": "css:S4667",
      "severity": "MAJOR",
      "component": "platform...
2025-04-15 22:03:35,634 - DEBUG - Prompt for 'Requirements are implemented completely according ...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"lin...
2025-04-15 22:03:35,635 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-15 22:03:35,635 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-15 22:03:35,635 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-15 22:03:35,635 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-15 22:03:35,636 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x1089f0cc0>
2025-04-15 22:03:35,636 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-15 22:03:35,636 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-15 22:03:35,637 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1089f0860>
2025-04-15 22:03:35,637 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_query_compatibility_header at 0x1089f3740>
2025-04-15 22:03:35,637 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1089f27a0>
2025-04-15 22:03:35,639 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"ef38b772-1c4c-447f-bc86-18b93a64dfdb\\",\\n      \\"rule\\": \\"css:S4667\\",\\n      \\"severity\\": \\"MAJOR\\",\\n      \\"component\\": \\"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\\",\\n      \\"line\\": 1,\\n      \\"message\\": \\"Unexpected em\\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: \\nQuestion: [\\n  {{\\n    \\"question\\": \\"Requirements are implemented completely according to the requirements without major use cases or experiences missing.\\",\\n    \\"category\\": \\"Functionality & Completeness\\",\\n    \\"weight\\": 50.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x108cd3b10>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-15 22:03:35,640 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x108cd3110>>
2025-04-15 22:03:35,640 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x1089f0ae0>
2025-04-15 22:03:35,640 - DEBUG - Calculating signature using v4 auth.
2025-04-15 22:03:35,640 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250415T150335Z

content-type;host;x-amz-date
be82fdcf4b029e06b471f20e8cf4decd03329f6350e1addb80ab466ed5a4380c
2025-04-15 22:03:35,641 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250415T150335Z
20250415/us-east-1/bedrock/aws4_request
6d4b467da75d878664879a789a67d44c24d7aa1b365a378642cd8b96ba337731
2025-04-15 22:03:35,641 - DEBUG - Signature:
d2f6d6d77548d35752d7f33014c4c03896aa64a117886cacda3714372076a35e
2025-04-15 22:03:35,641 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1089f2fc0>
2025-04-15 22:03:35,641 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99', 'X-Amz-Date': b'20250415T150335Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250415/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=d2f6d6d77548d35752d7f33014c4c03896aa64a117886cacda3714372076a35e', 'amz-sdk-invocation-id': b'7f4bfa3e-9b39-44e1-90a3-03a6de428dce', 'amz-sdk-request': b'attempt=1', 'Content-Length': '1757'}>
2025-04-15 22:03:36,632 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 175
2025-04-15 22:03:36,633 - DEBUG - Response headers: {'Date': 'Tue, 15 Apr 2025 15:03:36 GMT', 'Content-Type': 'application/json', 'Content-Length': '175', 'Connection': 'keep-alive', 'x-amzn-RequestId': '17a77f1e-4bd2-4a4f-bd3f-f0cd4f28444a', 'X-Amzn-Bedrock-Invocation-Latency': '715', 'X-Amzn-Bedrock-Output-Token-Count': '31', 'X-Amzn-Bedrock-Input-Token-Count': '540'}
2025-04-15 22:03:36,633 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x109c06080>
2025-04-15 22:03:36,633 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x109bcce10>
2025-04-15 22:03:36,633 - DEBUG - No retry needed.
2025-04-15 22:03:36,634 - DEBUG - Bedrock response status: 200
2025-04-15 22:03:36,634 - DEBUG - Raw response: {"outputs": [{"text": "{\"answer\": \"Unable to determine completeness from provided code and SonarQube issues. Need more context.\", \"confidence\": 3}", "stop_reason": "stop"}]}...
2025-04-15 22:03:36,634 - DEBUG - NLP raw response for 'Requirements are implemented completely according ...': {"answer": "Unable to determine completeness from provided code and SonarQube issues. Need more context.", "confidence": 3}...
2025-04-15 22:03:36,635 - DEBUG - Parsed JSON: [{'answer': 'Unable to determine completeness from provided code and SonarQube issues. Need more context.', 'confidence': 3}]
2025-04-15 22:03:36,635 - DEBUG - Generated answer: {'question': 'Requirements are implemented completely according to the requirements without major use cases or experiences missing.', 'category': 'Functionality & Completeness', 'answer': 'Unable to determine completeness from provided code and SonarQube issues. Need more context.', 'confidence': 3, 'weight': 50.0}
2025-04-15 22:03:36,635 - DEBUG - Processing question: The technical solution is modern and designed with...
2025-04-15 22:03:36,635 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-15 22:03:36,636 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-15 22:03:36,636 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-15 22:03:36,636 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"line\": 1,\n      \"message\": \"Unexpected em", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.join(os...
2025-04-15 22:03:36,636 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "ef38b772-1c4c-447f-bc86-18b93a64dfdb",
      "rule": "css:S4667",
      "severity": "MAJOR",
      "component": "platform...
2025-04-15 22:03:36,636 - DEBUG - Prompt for 'The technical solution is modern and designed with...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"lin...
2025-04-15 22:03:36,637 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-15 22:03:36,637 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-15 22:03:36,637 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-15 22:03:36,637 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-15 22:03:36,638 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x1089f0cc0>
2025-04-15 22:03:36,639 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-15 22:03:36,639 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-15 22:03:36,640 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1089f0860>
2025-04-15 22:03:36,640 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_query_compatibility_header at 0x1089f3740>
2025-04-15 22:03:36,640 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1089f27a0>
2025-04-15 22:03:36,640 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"ef38b772-1c4c-447f-bc86-18b93a64dfdb\\",\\n      \\"rule\\": \\"css:S4667\\",\\n      \\"severity\\": \\"MAJOR\\",\\n      \\"component\\": \\"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\\",\\n      \\"line\\": 1,\\n      \\"message\\": \\"Unexpected em\\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: \\nQuestion: [\\n  {{\\n    \\"question\\": \\"The technical solution is modern and designed with best practices to complement the requirements.\\",\\n    \\"category\\": \\"Technical Implementation\\",\\n    \\"weight\\": 20.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x108cd3b10>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-15 22:03:36,641 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x108cd3110>>
2025-04-15 22:03:36,641 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x1089f0ae0>
2025-04-15 22:03:36,642 - DEBUG - Calculating signature using v4 auth.
2025-04-15 22:03:36,642 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250415T150336Z

content-type;host;x-amz-date
02abce7ac3226a6cd3a539f4d7c30366f86a00abb9697a5443ccfad42b4c047d
2025-04-15 22:03:36,642 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250415T150336Z
20250415/us-east-1/bedrock/aws4_request
d8ff637261ace63094c8c40f99bd5a55d926aa841f6e8802a4752bb1a3e2c989
2025-04-15 22:03:36,642 - DEBUG - Signature:
e0a07b8345bc3c522976949b230c4fbdebf76df5d2fb2e4d352921b077b6a31a
2025-04-15 22:03:36,642 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1089f2fc0>
2025-04-15 22:03:36,643 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99', 'X-Amz-Date': b'20250415T150336Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250415/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=e0a07b8345bc3c522976949b230c4fbdebf76df5d2fb2e4d352921b077b6a31a', 'amz-sdk-invocation-id': b'716b5707-dad1-4513-8b12-324e3ea29377', 'amz-sdk-request': b'attempt=1', 'Content-Length': '1733'}>
2025-04-15 22:03:37,925 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 234
2025-04-15 22:03:37,925 - DEBUG - Response headers: {'Date': 'Tue, 15 Apr 2025 15:03:37 GMT', 'Content-Type': 'application/json', 'Content-Length': '234', 'Connection': 'keep-alive', 'x-amzn-RequestId': '780d811e-25e7-4c8a-8399-b0f9d821a0f6', 'X-Amzn-Bedrock-Invocation-Latency': '1026', 'X-Amzn-Bedrock-Output-Token-Count': '43', 'X-Amzn-Bedrock-Input-Token-Count': '536'}
2025-04-15 22:03:37,926 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x109c06020>
2025-04-15 22:03:37,926 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x109bcce10>
2025-04-15 22:03:37,926 - DEBUG - No retry needed.
2025-04-15 22:03:37,927 - DEBUG - Bedrock response status: 200
2025-04-15 22:03:37,927 - DEBUG - Raw response: {"outputs": [{"text": "{\"answer\": \"The code uses modern libraries and follows best practices such as logging and file handling. However, there is a major CSS issue detected by SonarQube.\", \"confidence\": 4}", "stop_reason": "stop"}]}...
2025-04-15 22:03:37,927 - DEBUG - NLP raw response for 'The technical solution is modern and designed with...': {"answer": "The code uses modern libraries and follows best practices such as logging and file handling. However, there is a major CSS issue detected by SonarQube.", "confidence": 4}...
2025-04-15 22:03:37,927 - DEBUG - Parsed JSON: [{'answer': 'The code uses modern libraries and follows best practices such as logging and file handling. However, there is a major CSS issue detected by SonarQube.', 'confidence': 4}]
2025-04-15 22:03:37,928 - DEBUG - Generated answer: {'question': 'The technical solution is modern and designed with best practices to complement the requirements.', 'category': 'Technical Implementation', 'answer': 'The code uses modern libraries and follows best practices such as logging and file handling. However, there is a major CSS issue detected by SonarQube.', 'confidence': 4, 'weight': 20.0}
2025-04-15 22:03:37,928 - DEBUG - Processing question: Complete and easy-to-follow documentation is inclu...
2025-04-15 22:03:37,928 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-15 22:03:37,928 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-15 22:03:37,928 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-15 22:03:37,929 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"line\": 1,\n      \"message\": \"Unexpected em", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.join(os...
2025-04-15 22:03:37,929 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "ef38b772-1c4c-447f-bc86-18b93a64dfdb",
      "rule": "css:S4667",
      "severity": "MAJOR",
      "component": "platform...
2025-04-15 22:03:37,929 - DEBUG - Prompt for 'Complete and easy-to-follow documentation is inclu...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"ef38b772-1c4c-447f-bc86-18b93a64dfdb\",\n      \"rule\": \"css:S4667\",\n      \"severity\": \"MAJOR\",\n      \"component\": \"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\",\n      \"lin...
2025-04-15 22:03:37,929 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-15 22:03:37,929 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-15 22:03:37,930 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-15 22:03:37,930 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-15 22:03:37,930 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x1089f0cc0>
2025-04-15 22:03:37,931 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-15 22:03:37,931 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-15 22:03:37,932 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1089f0860>
2025-04-15 22:03:37,932 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_query_compatibility_header at 0x1089f3740>
2025-04-15 22:03:37,932 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1089f27a0>
2025-04-15 22:03:37,932 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"ef38b772-1c4c-447f-bc86-18b93a64dfdb\\",\\n      \\"rule\\": \\"css:S4667\\",\\n      \\"severity\\": \\"MAJOR\\",\\n      \\"component\\": \\"platform-ui:src/apps/dev-center/src/dev-center-pages/platform-ui-app/storybook/Storybook.module.scss\\",\\n      \\"line\\": 1,\\n      \\"message\\": \\"Unexpected em\\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: \\nQuestion: [\\n  {{\\n    \\"question\\": \\"Complete and easy-to-follow documentation is included with the solution. This includes instructions to setup and run the solution in addition to a demo video.\\",\\n    \\"category\\": \\"Presentation (Docs & Demo)\\",\\n    \\"weight\\": 10.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x108cd3b10>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-15 22:03:37,933 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x108cd3110>>
2025-04-15 22:03:37,933 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x1089f0ae0>
2025-04-15 22:03:37,934 - DEBUG - Calculating signature using v4 auth.
2025-04-15 22:03:37,934 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250415T150337Z

content-type;host;x-amz-date
0cb4ae6bee59f7734db4075a92e111ef38dc4f5ce04fbe5a60b4ff91fc23438a
2025-04-15 22:03:37,934 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250415T150337Z
20250415/us-east-1/bedrock/aws4_request
f50564f56202fb7776639df7c4d98fa69d7a6183ac93ae01ea16757dfeb5c24b
2025-04-15 22:03:37,934 - DEBUG - Signature:
095b6285048f5de96fd4530aece7fb3b395b00d74ec1e46c57ea12bcb1521a1d
2025-04-15 22:03:37,935 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1089f2fc0>
2025-04-15 22:03:37,935 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.99 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.99', 'X-Amz-Date': b'20250415T150337Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250415/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=095b6285048f5de96fd4530aece7fb3b395b00d74ec1e46c57ea12bcb1521a1d', 'amz-sdk-invocation-id': b'004c828f-f0fa-402f-94f8-0fc933f16dae', 'amz-sdk-request': b'attempt=1', 'Content-Length': '1796'}>
2025-04-15 22:03:39,406 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 272
2025-04-15 22:03:39,407 - DEBUG - Response headers: {'Date': 'Tue, 15 Apr 2025 15:03:39 GMT', 'Content-Type': 'application/json', 'Content-Length': '272', 'Connection': 'keep-alive', 'x-amzn-RequestId': 'a9bf6262-98fe-4974-8f9c-369520254b31', 'X-Amzn-Bedrock-Invocation-Latency': '1143', 'X-Amzn-Bedrock-Output-Token-Count': '48', 'X-Amzn-Bedrock-Input-Token-Count': '554'}
2025-04-15 22:03:39,407 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x109b6bd30>
2025-04-15 22:03:39,407 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x109bcce10>
2025-04-15 22:03:39,408 - DEBUG - No retry needed.
2025-04-15 22:03:39,408 - DEBUG - Bedrock response status: 200
2025-04-15 22:03:39,408 - DEBUG - Raw response: {"outputs": [{"text": "{\"answer\": \"The provided code snippet does not include any documentation or instructions to setup and run the solution. No demo video is mentioned. SonarQube issues do not provide relevant information.\", \"confidence\": 5}", "stop_reason": "stop"}]}...
2025-04-15 22:03:39,409 - DEBUG - NLP raw response for 'Complete and easy-to-follow documentation is inclu...': {"answer": "The provided code snippet does not include any documentation or instructions to setup and run the solution. No demo video is mentioned. SonarQube issues do not provide relevant information.", "confidence": 5}...
2025-04-15 22:03:39,409 - DEBUG - Parsed JSON: [{'answer': 'The provided code snippet does not include any documentation or instructions to setup and run the solution. No demo video is mentioned. SonarQube issues do not provide relevant information.', 'confidence': 5}]
2025-04-15 22:03:39,409 - DEBUG - Generated answer: {'question': 'Complete and easy-to-follow documentation is included with the solution. This includes instructions to setup and run the solution in addition to a demo video.', 'category': 'Presentation (Docs & Demo)', 'answer': 'The provided code snippet does not include any documentation or instructions to setup and run the solution. No demo video is mentioned. SonarQube issues do not provide relevant information.', 'confidence': 5, 'weight': 10.0}
2025-04-15 22:03:39,410 - INFO - Processed questions: 4 answers generated
2025-04-15 22:03:39,410 - DEBUG - Scorecard set: 4 valid answers
2025-04-15 22:03:39,410 - INFO - Review completed: {
  "screening_result": {
    "valid": true,
    "reason": null,
    "languages": [
      "Python",
      "HTML",
      "JavaScript"
    ]
  },
  "security_findings": [],
  "quality_metrics": {
    "maintainability_score": 50,
    "code_smells": 2,
    "doc_coverage": 0
  },
  "performance_metrics": {
    "rating": 60,
    "bottlenecks": [],
    "optimization_suggestions": []
  },
  "scorecard": [
    {
      "question": "The solution provides a unique approach to solving the given problem(s).",...
2025-04-15 22:03:39,416 - DEBUG - Review result: {
  "screening_result": {
    "valid": true,
    "reason": null,
    "languages": [
      "Python",
      "HTML",
      "JavaScript"
    ]
  },
  "security_findings": [],
  "quality_metrics": {
    "maintainability_score": 50,
    "code_smells": 2,
    "doc_coverage": 0
  },
  "performance_metrics": {
    "rating": 60,
    "bottlenecks": [],
    "optimization_suggestions": []
  },
  "scorecard": [
    {
      "question": "The solution provides a unique approach to solving the given problem(s).",...
2025-04-15 22:03:39,419 - INFO - Report generated: report.json
2025-04-16 16:44:46,578 - DEBUG - Using selector: KqueueSelector
2025-04-16 16:44:46,580 - DEBUG - Running cli.py from: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/app/cli.py
2025-04-16 16:44:46,580 - DEBUG - os module loaded: <module 'os' (frozen)>
2025-04-16 16:44:46,582 - DEBUG - Validating files: tests/test_data/sonar-report.json, tests/test_data/submission.zip, tests/test_data/spec.txt, tests/test_data/scorecard.json
2025-04-16 16:44:46,582 - DEBUG - Initializing MasterAgent with model_name=parallel, backend=bedrock, tech_stack=['TypeScript', ' Python']
2025-04-16 16:44:46,582 - DEBUG - Normalized 'TypeScript' to 'TypeScript'
2025-04-16 16:44:46,582 - DEBUG - Normalized 'TypeScript' to 'TypeScript'
2025-04-16 16:44:46,583 - DEBUG - Normalized 'Python' to 'Python'
2025-04-16 16:44:46,583 - DEBUG - Normalized 'Python' to 'Python'
2025-04-16 16:44:46,584 - DEBUG - Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2025-04-16 16:44:46,587 - DEBUG - Changing event name from before-call.apigateway to before-call.api-gateway
2025-04-16 16:44:46,588 - DEBUG - Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2025-04-16 16:44:46,590 - DEBUG - Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2025-04-16 16:44:46,591 - DEBUG - Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2025-04-16 16:44:46,591 - DEBUG - Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2025-04-16 16:44:46,592 - DEBUG - Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2025-04-16 16:44:46,669 - DEBUG - Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2025-04-16 16:44:46,670 - DEBUG - Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2025-04-16 16:44:46,670 - DEBUG - Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2025-04-16 16:44:46,670 - DEBUG - Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2025-04-16 16:44:46,709 - DEBUG - IMDS ENDPOINT: http://169.254.169.254/
2025-04-16 16:44:46,730 - DEBUG - Looking for credentials via: env
2025-04-16 16:44:46,730 - DEBUG - Looking for credentials via: assume-role
2025-04-16 16:44:46,730 - DEBUG - Looking for credentials via: assume-role-with-web-identity
2025-04-16 16:44:46,731 - DEBUG - Looking for credentials via: sso
2025-04-16 16:44:46,731 - DEBUG - Looking for credentials via: shared-credentials-file
2025-04-16 16:44:46,747 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2025-04-16 16:44:46,764 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/endpoints.json
2025-04-16 16:44:46,837 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/sdk-default-configuration.json
2025-04-16 16:44:46,838 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x102996520>
2025-04-16 16:44:46,901 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/bedrock-runtime/2023-09-30/service-2.json.gz
2025-04-16 16:44:47,015 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/bedrock-runtime/2023-09-30/endpoint-rule-set-1.json.gz
2025-04-16 16:44:47,018 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/partitions.json
2025-04-16 16:44:47,031 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x10287f420>
2025-04-16 16:44:47,041 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-16 16:44:47,041 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-16 16:44:47,041 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-16 16:44:47,041 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-16 16:44:47,041 - DEBUG - No configured endpoint found.
2025-04-16 16:44:47,042 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-16 16:44:47,062 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-16 16:44:47,078 - DEBUG - Loading JSON file: /Users/mirzailhami/Desktop/topcoder/ai-code-reviewer/venv/lib/python3.13/site-packages/botocore/data/_retry.json
2025-04-16 16:44:47,079 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-16 16:44:47,080 - DEBUG - Initialized Bedrock client: model_name=mistral_large, region=us-east-1
2025-04-16 16:44:47,093 - DEBUG - Loading config for model: mistral_large
2025-04-16 16:44:47,141 - DEBUG - Model config for mistral_large: {'model_id': 'mistral.mistral-large-2402-v1:0', 'max_tokens': 256, 'temperature': 0.3, 'top_p': 0.9, 'top_k': 50}
2025-04-16 16:44:47,141 - DEBUG - ValidationAgent initialized with tech_stack=['TypeScript', 'Python'], model_name=mistral_large, model_backend=bedrock
2025-04-16 16:44:47,142 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x102996520>
2025-04-16 16:44:47,144 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x10287f420>
2025-04-16 16:44:47,144 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-16 16:44:47,145 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-16 16:44:47,145 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-16 16:44:47,145 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-16 16:44:47,145 - DEBUG - No configured endpoint found.
2025-04-16 16:44:47,146 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-16 16:44:47,154 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-16 16:44:47,160 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-16 16:44:47,161 - DEBUG - Initialized Bedrock client: model_name=mistral_large, region=us-east-1
2025-04-16 16:44:47,161 - DEBUG - Loading config for model: mistral_large
2025-04-16 16:44:47,193 - DEBUG - Model config for mistral_large: {'model_id': 'mistral.mistral-large-2402-v1:0', 'max_tokens': 256, 'temperature': 0.3, 'top_p': 0.9, 'top_k': 50}
2025-04-16 16:44:47,237 - DEBUG - Loaded prompts: dict_keys(['nlp_questions', 'security', 'quality', 'performance'])
2025-04-16 16:44:47,250 - DEBUG - Loaded prompts: dict_keys(['nlp_questions', 'security', 'quality', 'performance'])
2025-04-16 16:44:47,251 - DEBUG - Calling MasterAgent.review_code
2025-04-16 16:44:47,251 - DEBUG - Starting review_code with model_name=parallel, zip_path=tests/test_data/submission.zip
2025-04-16 16:44:47,252 - DEBUG - Validating zip: tests/test_data/submission.zip
2025-04-16 16:44:47,276 - DEBUG - Files in tests/test_data/submission.zip: ['app/core/llm/__init__.py', 'app/core/llm/bedrock_llm.py', 'app/core/llm/manager.py', 'app/core/__init__.py', 'app/core/agents/master_agent.py', 'app/core/agents/__init__.py', 'app/core/agents/validation_agent.py', 'app/core/agents/nlp_question_agent.py', 'app/core/processors/chunk_splitter.py', 'app/core/processors/zip_processor.py', 'app/core/processors/__init__.py', 'app/core/processors/sonar_parser.py', 'app/__init__.py', 'app/cli.py', 'app/static/js/app.js', 'app/templates/index.html', 'app/main.py']
2025-04-16 16:44:47,277 - DEBUG - Detected languages: ['Python', 'JavaScript', 'HTML']
2025-04-16 16:44:47,277 - DEBUG - Expected tech stack: ['TypeScript', 'Python']
2025-04-16 16:44:47,277 - DEBUG - Matching languages: ['Python']
2025-04-16 16:44:47,278 - INFO - Validation passed with matching languages: Python
2025-04-16 16:44:47,279 - DEBUG - Parsed sonar_data: {"issues": [{"key": "191af786-5643-42be-ad0f-ef4f2d0d6e52", "rule": "python:S5717", "severity": "CRITICAL", "component": "ai-code-reviewer:app/core/agents/master_agent.py", "line": 18, "message": "Cha...
2025-04-16 16:44:47,368 - DEBUG - Extracted 2 code chunks
2025-04-16 16:44:47,369 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x102996520>
2025-04-16 16:44:47,369 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x10287f420>
2025-04-16 16:44:47,370 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-16 16:44:47,370 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-16 16:44:47,371 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-16 16:44:47,371 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-16 16:44:47,373 - DEBUG - No configured endpoint found.
2025-04-16 16:44:47,373 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-16 16:44:47,392 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-16 16:44:47,395 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-16 16:44:47,407 - DEBUG - Initialized Bedrock client: model_name=mistral_large, region=us-east-1
2025-04-16 16:44:47,407 - DEBUG - Loading config for model: mistral_large
2025-04-16 16:44:47,424 - DEBUG - Model config for mistral_large: {'model_id': 'mistral.mistral-large-2402-v1:0', 'max_tokens': 256, 'temperature': 0.3, 'top_p': 0.9, 'top_k': 50}
2025-04-16 16:44:47,425 - DEBUG - Event choose-service-name: calling handler <function handle_service_name_alias at 0x102996520>
2025-04-16 16:44:47,425 - DEBUG - Event creating-client-class.bedrock-runtime: calling handler <function add_generate_presigned_url at 0x10287f420>
2025-04-16 16:44:47,426 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_service
2025-04-16 16:44:47,426 - DEBUG - Looking for endpoint for bedrock-runtime via: environment_global
2025-04-16 16:44:47,426 - DEBUG - Looking for endpoint for bedrock-runtime via: config_service
2025-04-16 16:44:47,426 - DEBUG - Looking for endpoint for bedrock-runtime via: config_global
2025-04-16 16:44:47,427 - DEBUG - No configured endpoint found.
2025-04-16 16:44:47,427 - DEBUG - Creating a regex based endpoint for bedrock-runtime, us-east-1
2025-04-16 16:44:47,438 - DEBUG - Setting bedrock-runtime timeout as (60, 60)
2025-04-16 16:44:47,444 - DEBUG - Registering retry handlers for service: bedrock-runtime
2025-04-16 16:44:47,446 - DEBUG - Initialized Bedrock client: model_name=llama3_70b, region=us-east-1
2025-04-16 16:44:47,447 - DEBUG - Loading config for model: llama3_70b
2025-04-16 16:44:47,461 - DEBUG - Model config for llama3_70b: {'model_id': 'arn:aws:bedrock:us-east-1:324037276468:inference-profile/us.meta.llama3-3-70b-instruct-v1:0', 'max_tokens': 256, 'temperature': 0.5, 'top_p': 0.9}
2025-04-16 16:44:47,462 - DEBUG - Analyzing security with model_name=mistral_large
2025-04-16 16:44:47,466 - DEBUG - Analyzing quality with model_name=llama3_70b
2025-04-16 16:44:47,466 - DEBUG - Analyzing performance with model_name=mistral_large
2025-04-16 16:44:47,471 - DEBUG - Analysis results - security: 0, quality: {'maintainability_score': 50, 'code_smells': 2, 'doc_coverage': 0}, performance: {'rating': 60, 'bottlenecks': [], 'optimization_suggestions': []}
2025-04-16 16:44:47,477 - DEBUG - Summary updated: {'code_quality': 50, 'security': 100, 'performance': 60, 'total': 6.8}
2025-04-16 16:44:47,479 - DEBUG - Loaded spec: Challenge Overview
Challenge Objective
Develop an AI Agent that can analyse static code review resul...
2025-04-16 16:44:47,479 - DEBUG - Processing questions with model_name=mistral_large, question_file=tests/test_data/scorecard.json
2025-04-16 16:44:47,481 - DEBUG - Loaded 4 questions: ['The solution provides a unique approach to solving', 'Requirements are implemented completely according ', 'The technical solution is modern and designed with', 'Complete and easy-to-follow documentation is inclu']
2025-04-16 16:44:47,481 - DEBUG - Processing question: The solution provides a unique approach to solving...
2025-04-16 16:44:47,482 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-16 16:44:47,482 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-16 16:44:47,482 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-16 16:44:47,483 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this default value to \\\"None\\\" and initialize this ", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.joi...
2025-04-16 16:44:47,484 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "191af786-5643-42be-ad0f-ef4f2d0d6e52",
      "rule": "python:S5717",
      "severity": "CRITICAL",
      "component": "ai...
2025-04-16 16:44:47,484 - DEBUG - Prompt for 'The solution provides a unique approach to solving...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this def...
2025-04-16 16:44:47,484 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-16 16:44:47,485 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-16 16:44:47,485 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-16 16:44:47,485 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-16 16:44:47,488 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x102996c00>
2025-04-16 16:44:47,489 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-16 16:44:47,490 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-16 16:44:47,491 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1029967a0>
2025-04-16 16:44:47,491 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1029ac720>
2025-04-16 16:44:47,494 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"191af786-5643-42be-ad0f-ef4f2d0d6e52\\",\\n      \\"rule\\": \\"python:S5717\\",\\n      \\"severity\\": \\"CRITICAL\\",\\n      \\"component\\": \\"ai-code-reviewer:app/core/agents/master_agent.py\\",\\n      \\"line\\": 18,\\n      \\"message\\": \\"Change this default value to \\\\\\\\\\"None\\\\\\\\\\" and initialize this \\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: Challenge Overview\\nChallenge Objective\\nDevelop an AI Agent that can analyse static code review results from tools like SonarQube and answer a set of NLP questions based on these results which are specific to the challenge being reviewed by the agent.\\n\\nTech Stack\\nNode.js (Typescript) or Python\\nLLM\\nSonarqube\\nInputs\\nThe AI Agent will be provided with following inputs and should use those to compile comprehensive submission code review according to the requirements:\\n\\nStatic Code Review Results: JSON\\nQuestion: [\\n  {{\\n    \\"question\\": \\"The solution provides a unique approach to solving the given problem(s).\\",\\n    \\"category\\": \\"Innovation & Creativity\\",\\n    \\"weight\\": 20.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x102c32fd0>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-16 16:44:47,495 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x102c325d0>>
2025-04-16 16:44:47,495 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x102996a20>
2025-04-16 16:44:47,497 - DEBUG - Calculating signature using v4 auth.
2025-04-16 16:44:47,497 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250416T094447Z

content-type;host;x-amz-date
f17e4de3ea8510cd1803b31994379e8d2a4bf1e5567c371786a169eff58cf341
2025-04-16 16:44:47,497 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250416T094447Z
20250416/us-east-1/bedrock/aws4_request
f86e72a88ffbe36244904b2cf095775d7ea418ace269d309eb5d15fab417c846
2025-04-16 16:44:47,497 - DEBUG - Signature:
c2b9900e91bad8f2bf781713e458be0d0ec15fbf181ccadcf65b5a9326d74d51
2025-04-16 16:44:47,498 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1029acf40>
2025-04-16 16:44:47,498 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41', 'X-Amz-Date': b'20250416T094447Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250416/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=c2b9900e91bad8f2bf781713e458be0d0ec15fbf181ccadcf65b5a9326d74d51', 'amz-sdk-invocation-id': b'2747805c-08e3-4e9c-87a3-e85721386bfb', 'amz-sdk-request': b'attempt=1', 'Content-Length': '2226'}>
2025-04-16 16:44:47,500 - DEBUG - Starting new HTTPS connection (1): bedrock-runtime.us-east-1.amazonaws.com:443
2025-04-16 16:44:49,828 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 286
2025-04-16 16:44:49,830 - DEBUG - Response headers: {'Date': 'Wed, 16 Apr 2025 09:44:49 GMT', 'Content-Type': 'application/json', 'Content-Length': '286', 'Connection': 'keep-alive', 'x-amzn-RequestId': '5816b564-20b0-4571-bfad-c208df90217c', 'X-Amzn-Bedrock-Invocation-Latency': '1182', 'X-Amzn-Bedrock-Output-Token-Count': '50', 'X-Amzn-Bedrock-Input-Token-Count': '645'}
2025-04-16 16:44:49,831 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x103b11090>
2025-04-16 16:44:49,831 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x103ab02d0>
2025-04-16 16:44:49,831 - DEBUG - No retry needed.
2025-04-16 16:44:49,832 - DEBUG - Bedrock response status: 200
2025-04-16 16:44:49,833 - DEBUG - Raw response: {"outputs": [{"text": "{\"answer\": \"The provided code does not show a unique approach to solving the problem, as it mainly consists of imports and logging setup. No confidence score can be given as the code does not address the problem.\", \"confidence\": null}", "stop_reason": "stop"}]}...
2025-04-16 16:44:49,833 - DEBUG - NLP raw response for 'The solution provides a unique approach to solving...': {"answer": "The provided code does not show a unique approach to solving the problem, as it mainly consists of imports and logging setup. No confidence score can be given as the code does not address the problem.", "confidence": null}...
2025-04-16 16:44:49,834 - DEBUG - Parsed JSON: [{'answer': 'The provided code does not show a unique approach to solving the problem, as it mainly consists of imports and logging setup. No confidence score can be given as the code does not address the problem.', 'confidence': None}]
2025-04-16 16:44:49,863 - ERROR - Error processing question 'The solution provides a unique approach to solving...': int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
2025-04-16 16:44:49,867 - DEBUG - Processing question: Requirements are implemented completely according ...
2025-04-16 16:44:49,868 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-16 16:44:49,868 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-16 16:44:49,868 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-16 16:44:49,868 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this default value to \\\"None\\\" and initialize this ", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.joi...
2025-04-16 16:44:49,889 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "191af786-5643-42be-ad0f-ef4f2d0d6e52",
      "rule": "python:S5717",
      "severity": "CRITICAL",
      "component": "ai...
2025-04-16 16:44:49,890 - DEBUG - Prompt for 'Requirements are implemented completely according ...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this def...
2025-04-16 16:44:49,890 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-16 16:44:49,890 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-16 16:44:49,935 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-16 16:44:49,935 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-16 16:44:49,968 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x102996c00>
2025-04-16 16:44:49,968 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-16 16:44:49,968 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-16 16:44:49,969 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1029967a0>
2025-04-16 16:44:49,969 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1029ac720>
2025-04-16 16:44:49,970 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"191af786-5643-42be-ad0f-ef4f2d0d6e52\\",\\n      \\"rule\\": \\"python:S5717\\",\\n      \\"severity\\": \\"CRITICAL\\",\\n      \\"component\\": \\"ai-code-reviewer:app/core/agents/master_agent.py\\",\\n      \\"line\\": 18,\\n      \\"message\\": \\"Change this default value to \\\\\\\\\\"None\\\\\\\\\\" and initialize this \\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: Challenge Overview\\nChallenge Objective\\nDevelop an AI Agent that can analyse static code review results from tools like SonarQube and answer a set of NLP questions based on these results which are specific to the challenge being reviewed by the agent.\\n\\nTech Stack\\nNode.js (Typescript) or Python\\nLLM\\nSonarqube\\nInputs\\nThe AI Agent will be provided with following inputs and should use those to compile comprehensive submission code review according to the requirements:\\n\\nStatic Code Review Results: JSON\\nQuestion: [\\n  {{\\n    \\"question\\": \\"Requirements are implemented completely according to the requirements without major use cases or experiences missing.\\",\\n    \\"category\\": \\"Functionality & Completeness\\",\\n    \\"weight\\": 50.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x102c32fd0>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-16 16:44:50,012 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x102c325d0>>
2025-04-16 16:44:50,012 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x102996a20>
2025-04-16 16:44:50,012 - DEBUG - Calculating signature using v4 auth.
2025-04-16 16:44:50,013 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250416T094450Z

content-type;host;x-amz-date
4b0ae4d04adce0aff7f7a66cd0c3c7c24eee1e4254006fa43506c11a86d0b1d1
2025-04-16 16:44:50,013 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250416T094450Z
20250416/us-east-1/bedrock/aws4_request
e460425d01dd7e291e1cbf6d11bad936645fc40aa331b3819cb5f8e2c8eed1a2
2025-04-16 16:44:50,013 - DEBUG - Signature:
2040c2e333b863a4a071a9058326b36348bfb0fcc14afe3c8dfd875eecd2cae5
2025-04-16 16:44:50,016 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1029acf40>
2025-04-16 16:44:50,016 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41', 'X-Amz-Date': b'20250416T094450Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250416/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=2040c2e333b863a4a071a9058326b36348bfb0fcc14afe3c8dfd875eecd2cae5', 'amz-sdk-invocation-id': b'32fa92e2-af28-45d3-b181-9c1673b63314', 'amz-sdk-request': b'attempt=1', 'Content-Length': '2276'}>
2025-04-16 16:44:51,044 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 176
2025-04-16 16:44:51,046 - DEBUG - Response headers: {'Date': 'Wed, 16 Apr 2025 09:44:50 GMT', 'Content-Type': 'application/json', 'Content-Length': '176', 'Connection': 'keep-alive', 'x-amzn-RequestId': '4161f97f-a5c2-400a-b889-08c56bb54278', 'X-Amzn-Bedrock-Invocation-Latency': '668', 'X-Amzn-Bedrock-Output-Token-Count': '28', 'X-Amzn-Bedrock-Input-Token-Count': '648'}
2025-04-16 16:44:51,047 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x103a4bb50>
2025-04-16 16:44:51,047 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x103ab02d0>
2025-04-16 16:44:51,047 - DEBUG - No retry needed.
2025-04-16 16:44:51,049 - DEBUG - Bedrock response status: 200
2025-04-16 16:44:51,050 - DEBUG - Raw response: {"outputs": [{"text": "{\"answer\": \"The requirement implementation seems incomplete due to a critical default value issue in the code. Confidence: 4\"}", "stop_reason": "stop"}]}...
2025-04-16 16:44:51,050 - DEBUG - NLP raw response for 'Requirements are implemented completely according ...': {"answer": "The requirement implementation seems incomplete due to a critical default value issue in the code. Confidence: 4"}...
2025-04-16 16:44:51,050 - DEBUG - Parsed JSON: [{'answer': 'The requirement implementation seems incomplete due to a critical default value issue in the code. Confidence: 4'}]
2025-04-16 16:44:51,050 - DEBUG - Generated answer: {'question': 'Requirements are implemented completely according to the requirements without major use cases or experiences missing.', 'category': 'Functionality & Completeness', 'answer': 'The requirement implementation seems incomplete due to a critical default value issue in the code. Confidence: 4', 'confidence': 2, 'weight': 50.0}
2025-04-16 16:44:51,051 - DEBUG - Processing question: The technical solution is modern and designed with...
2025-04-16 16:44:51,051 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-16 16:44:51,051 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-16 16:44:51,052 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-16 16:44:51,055 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this default value to \\\"None\\\" and initialize this ", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.joi...
2025-04-16 16:44:51,055 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "191af786-5643-42be-ad0f-ef4f2d0d6e52",
      "rule": "python:S5717",
      "severity": "CRITICAL",
      "component": "ai...
2025-04-16 16:44:51,055 - DEBUG - Prompt for 'The technical solution is modern and designed with...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this def...
2025-04-16 16:44:51,078 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-16 16:44:51,078 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-16 16:44:51,078 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-16 16:44:51,079 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-16 16:44:51,087 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x102996c00>
2025-04-16 16:44:51,088 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-16 16:44:51,088 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-16 16:44:51,102 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1029967a0>
2025-04-16 16:44:51,102 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1029ac720>
2025-04-16 16:44:51,104 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"191af786-5643-42be-ad0f-ef4f2d0d6e52\\",\\n      \\"rule\\": \\"python:S5717\\",\\n      \\"severity\\": \\"CRITICAL\\",\\n      \\"component\\": \\"ai-code-reviewer:app/core/agents/master_agent.py\\",\\n      \\"line\\": 18,\\n      \\"message\\": \\"Change this default value to \\\\\\\\\\"None\\\\\\\\\\" and initialize this \\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: Challenge Overview\\nChallenge Objective\\nDevelop an AI Agent that can analyse static code review results from tools like SonarQube and answer a set of NLP questions based on these results which are specific to the challenge being reviewed by the agent.\\n\\nTech Stack\\nNode.js (Typescript) or Python\\nLLM\\nSonarqube\\nInputs\\nThe AI Agent will be provided with following inputs and should use those to compile comprehensive submission code review according to the requirements:\\n\\nStatic Code Review Results: JSON\\nQuestion: [\\n  {{\\n    \\"question\\": \\"The technical solution is modern and designed with best practices to complement the requirements.\\",\\n    \\"category\\": \\"Technical Implementation\\",\\n    \\"weight\\": 20.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x102c32fd0>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-16 16:44:51,152 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x102c325d0>>
2025-04-16 16:44:51,152 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x102996a20>
2025-04-16 16:44:51,153 - DEBUG - Calculating signature using v4 auth.
2025-04-16 16:44:51,153 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250416T094451Z

content-type;host;x-amz-date
be35cd024d606d16f3c70d1a657ce701b4ca90b2a732eb8422ba77a4fb8812cb
2025-04-16 16:44:51,160 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250416T094451Z
20250416/us-east-1/bedrock/aws4_request
6595cd8848e372d91f9165b313a0f3fb1d5bb19163af0f0c5c92bb09d6939b71
2025-04-16 16:44:51,160 - DEBUG - Signature:
e5e4f6ead0ff4068a2d66144808ff4abe5b6997f6cb059d7910ed96890ffeb89
2025-04-16 16:44:51,160 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1029acf40>
2025-04-16 16:44:51,165 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41', 'X-Amz-Date': b'20250416T094451Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250416/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=e5e4f6ead0ff4068a2d66144808ff4abe5b6997f6cb059d7910ed96890ffeb89', 'amz-sdk-invocation-id': b'6f3f3746-7be1-4e7c-b558-cda81566d9d1', 'amz-sdk-request': b'attempt=1', 'Content-Length': '2252'}>
2025-04-16 16:44:52,674 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 252
2025-04-16 16:44:52,675 - DEBUG - Response headers: {'Date': 'Wed, 16 Apr 2025 09:44:52 GMT', 'Content-Type': 'application/json', 'Content-Length': '252', 'Connection': 'keep-alive', 'x-amzn-RequestId': 'f9c71c89-1656-4269-bd17-9df3bcf9b83b', 'X-Amzn-Bedrock-Invocation-Latency': '1085', 'X-Amzn-Bedrock-Output-Token-Count': '49', 'X-Amzn-Bedrock-Input-Token-Count': '644'}
2025-04-16 16:44:52,675 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x103a4b5b0>
2025-04-16 16:44:52,675 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x103ab02d0>
2025-04-16 16:44:52,675 - DEBUG - No retry needed.
2025-04-16 16:44:52,676 - DEBUG - Bedrock response status: 200
2025-04-16 16:44:52,676 - DEBUG - Raw response: {"outputs": [{"text": "{\"answer\": \"The code does not seem to have modern practices or align with requirements, as indicated by a critical issue in SonarQube. The default value should be changed to 'None'.\", \"confidence\": 4}", "stop_reason": "stop"}]}...
2025-04-16 16:44:52,677 - DEBUG - NLP raw response for 'The technical solution is modern and designed with...': {"answer": "The code does not seem to have modern practices or align with requirements, as indicated by a critical issue in SonarQube. The default value should be changed to 'None'.", "confidence": 4}...
2025-04-16 16:44:52,677 - DEBUG - Parsed JSON: [{'answer': "The code does not seem to have modern practices or align with requirements, as indicated by a critical issue in SonarQube. The default value should be changed to 'None'.", 'confidence': 4}]
2025-04-16 16:44:52,677 - DEBUG - Generated answer: {'question': 'The technical solution is modern and designed with best practices to complement the requirements.', 'category': 'Technical Implementation', 'answer': "The code does not seem to have modern practices or align with requirements, as indicated by a critical issue in SonarQube. The default value should be changed to 'None'.", 'confidence': 4, 'weight': 20.0}
2025-04-16 16:44:52,677 - DEBUG - Processing question: Complete and easy-to-follow documentation is inclu...
2025-04-16 16:44:52,677 - DEBUG - User prompt template (raw): 'Evaluate the code submission based on the following:\n- SonarQube data: {sonar_data}\n- Code samples: {code_samples}\n- Specification: {spec}\n- Questions: {questions}\nReturn JSON only: [{\\"answer\...
2025-04-16 16:44:52,678 - WARNING - Invalid prompt keys found: {'\\"answer\\": \\"string\\", \\"confidence\\": 1-5'}. Using fallback template.
2025-04-16 16:44:52,678 - DEBUG - Validated prompt template: Evaluate the code submission:
SonarQube: {sonar_data}
Code: {code_samples}
Spec: {spec}
Question: {questions}
Provide a concise answer (up to 200 characters) addressing the question. Use SonarQube iss...
2025-04-16 16:44:52,678 - DEBUG - Prompt format args: {"sonar_data": "{\n  \"issues\": [\n    {\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this default value to \\\"None\\\" and initialize this ", "code_samples": "[\n  {\n    \"path\": \"app/cli.py\",\n    \"content\": \"import sys\\nimport os\\nsys.path.insert(0, os.path.abspath(os.path.joi...
2025-04-16 16:44:52,678 - DEBUG - Formatted user content: Evaluate the code submission:
SonarQube: {{
  "issues": [
    {{
      "key": "191af786-5643-42be-ad0f-ef4f2d0d6e52",
      "rule": "python:S5717",
      "severity": "CRITICAL",
      "component": "ai...
2025-04-16 16:44:52,678 - DEBUG - Prompt for 'Complete and easy-to-follow documentation is inclu...': [{"role": "system", "content": "You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]."}, {"role": "user", "content": "Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [\n    {{\n      \"key\": \"191af786-5643-42be-ad0f-ef4f2d0d6e52\",\n      \"rule\": \"python:S5717\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"ai-code-reviewer:app/core/agents/master_agent.py\",\n      \"line\": 18,\n      \"message\": \"Change this def...
2025-04-16 16:44:52,678 - DEBUG - Generating with model: mistral_large (model_id: mistral.mistral-large-2402-v1:0)
2025-04-16 16:44:52,679 - DEBUG - Formatted Mistral prompt: [INST] You are a code evaluation expert. Return JSON only: [{"answer": "string", "confidence": numbe...
2025-04-16 16:44:52,679 - DEBUG - Invoking Bedrock model: mistral.mistral-large-2402-v1:0 (Attempt 1/2)
2025-04-16 16:44:52,679 - DEBUG - Request body: {"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\"answer\": \"string\", \"confidence\": number}]. [/INST]\n[INST] Evaluate the code submission:\nSonarQube: {{\n  \"issues\": [...
2025-04-16 16:44:52,683 - DEBUG - Event before-parameter-build.bedrock-runtime.InvokeModel: calling handler <function generate_idempotent_uuid at 0x102996c00>
2025-04-16 16:44:52,684 - DEBUG - Calling endpoint provider with parameters: {'Region': 'us-east-1', 'UseDualStack': False, 'UseFIPS': False}
2025-04-16 16:44:52,684 - DEBUG - Endpoint provider result: https://bedrock-runtime.us-east-1.amazonaws.com
2025-04-16 16:44:52,700 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function add_recursion_detection_header at 0x1029967a0>
2025-04-16 16:44:52,701 - DEBUG - Event before-call.bedrock-runtime.InvokeModel: calling handler <function inject_api_version_header_if_needed at 0x1029ac720>
2025-04-16 16:44:52,703 - DEBUG - Making request for OperationModel(name=InvokeModel) with params: {'url_path': '/model/mistral.mistral-large-2402-v1%3A0/invoke', 'query_string': {}, 'method': 'POST', 'headers': {'Content-Type': 'application/json', 'User-Agent': 'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41'}, 'body': b'{"prompt": "[INST] You are a code evaluation expert. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": number}]. [/INST]\\n[INST] Evaluate the code submission:\\nSonarQube: {{\\n  \\"issues\\": [\\n    {{\\n      \\"key\\": \\"191af786-5643-42be-ad0f-ef4f2d0d6e52\\",\\n      \\"rule\\": \\"python:S5717\\",\\n      \\"severity\\": \\"CRITICAL\\",\\n      \\"component\\": \\"ai-code-reviewer:app/core/agents/master_agent.py\\",\\n      \\"line\\": 18,\\n      \\"message\\": \\"Change this default value to \\\\\\\\\\"None\\\\\\\\\\" and initialize this \\nCode: [\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"import sys\\\\\\\\nimport os\\\\\\\\nsys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), \'..\')))\\\\\\\\n\\\\\\\\nimport argparse\\\\\\\\nimport json\\\\\\\\nfrom app.core.agents.master_agent import MasterAgent\\\\\\\\nimport logging\\"\\n  }},\\n  {{\\n    \\"path\\": \\"app/cli.py\\",\\n    \\"content\\": \\"\\\\\\\\nimport asyncio\\\\\\\\n\\\\\\\\nlogging.basicConfig(\\\\\\\\n    level=logging.DEBUG,\\\\\\\\n    format=\'%(asctime)s - %(levelname)s - %(message)s\',\\\\\\\\n    handlers=[\\\\\\\\n        logging.FileHandler(\'cli_debug.log\'),\\\\\\\\n    \\nSpec: Challenge Overview\\nChallenge Objective\\nDevelop an AI Agent that can analyse static code review results from tools like SonarQube and answer a set of NLP questions based on these results which are specific to the challenge being reviewed by the agent.\\n\\nTech Stack\\nNode.js (Typescript) or Python\\nLLM\\nSonarqube\\nInputs\\nThe AI Agent will be provided with following inputs and should use those to compile comprehensive submission code review according to the requirements:\\n\\nStatic Code Review Results: JSON\\nQuestion: [\\n  {{\\n    \\"question\\": \\"Complete and easy-to-follow documentation is included with the solution. This includes instructions to setup and run the solution in addition to a demo video.\\",\\n    \\"category\\": \\"Presentation (Docs & Demo)\\",\\n    \\"weight\\": 10.0\\n  }}\\n]\\nProvide a concise answer (up to 200 characters) addressing the question. Use SonarQube issues, code, and spec to justify your response. Return JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}].\\nReturn JSON only: [{\\"answer\\": \\"string\\", \\"confidence\\": 1-5}]. Do not include prose, explanations, markdown, or code blocks. [/INST]\\n", "max_tokens": 256, "temperature": 0.3, "top_p": 0.9, "top_k": 50}', 'url': 'https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x102c32fd0>, 'has_streaming_input': True, 'auth_type': None, 'unsigned_payload': None}}
2025-04-16 16:44:52,733 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x102c325d0>>
2025-04-16 16:44:52,733 - DEBUG - Event choose-signer.bedrock-runtime.InvokeModel: calling handler <function set_operation_specific_signer at 0x102996a20>
2025-04-16 16:44:52,734 - DEBUG - Calculating signature using v4 auth.
2025-04-16 16:44:52,734 - DEBUG - CanonicalRequest:
POST
/model/mistral.mistral-large-2402-v1%253A0/invoke

content-type:application/json
host:bedrock-runtime.us-east-1.amazonaws.com
x-amz-date:20250416T094452Z

content-type;host;x-amz-date
08914f46178946284d6489dc7df3cca9e9e11473ab1c560eecba04e3b3d9e0e0
2025-04-16 16:44:52,734 - DEBUG - StringToSign:
AWS4-HMAC-SHA256
20250416T094452Z
20250416/us-east-1/bedrock/aws4_request
1a3a3ffb5b0cfbcd15a5aee1ec98a9d18ccf5de1e5a5e05e0c2a2b9ba6503616
2025-04-16 16:44:52,735 - DEBUG - Signature:
31d77b75a212fd5e92771eb0de10068cb2c3a2abfd494ee4760dd770c1d565d1
2025-04-16 16:44:52,735 - DEBUG - Event request-created.bedrock-runtime.InvokeModel: calling handler <function add_retry_headers at 0x1029acf40>
2025-04-16 16:44:52,735 - DEBUG - Sending http request: <AWSPreparedRequest stream_output=True, method=POST, url=https://bedrock-runtime.us-east-1.amazonaws.com/model/mistral.mistral-large-2402-v1%3A0/invoke, headers={'Content-Type': b'application/json', 'User-Agent': b'Boto3/1.35.29 md/Botocore#1.35.41 ua/2.0 os/macos#19.6.0 md/arch#x86_64 lang/python#3.13.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.35.41', 'X-Amz-Date': b'20250416T094452Z', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAUW4RAOM2CDCHRUWN/20250416/us-east-1/bedrock/aws4_request, SignedHeaders=content-type;host;x-amz-date, Signature=31d77b75a212fd5e92771eb0de10068cb2c3a2abfd494ee4760dd770c1d565d1', 'amz-sdk-invocation-id': b'5959bf75-c09d-48ba-81f6-507ce7d233ab', 'amz-sdk-request': b'attempt=1', 'Content-Length': '2315'}>
2025-04-16 16:44:55,746 - DEBUG - https://bedrock-runtime.us-east-1.amazonaws.com:443 "POST /model/mistral.mistral-large-2402-v1%3A0/invoke HTTP/1.1" 200 545
2025-04-16 16:44:55,747 - DEBUG - Response headers: {'Date': 'Wed, 16 Apr 2025 09:44:55 GMT', 'Content-Type': 'application/json', 'Content-Length': '545', 'Connection': 'keep-alive', 'x-amzn-RequestId': '00b85e20-1bcc-444e-9b1f-54d5a419f6a4', 'X-Amzn-Bedrock-Invocation-Latency': '2576', 'X-Amzn-Bedrock-Output-Token-Count': '122', 'X-Amzn-Bedrock-Input-Token-Count': '662'}
2025-04-16 16:44:55,747 - DEBUG - Response body:
<botocore.response.StreamingBody object at 0x103a49ed0>
2025-04-16 16:44:55,748 - DEBUG - Event needs-retry.bedrock-runtime.InvokeModel: calling handler <botocore.retryhandler.RetryHandler object at 0x103ab02d0>
2025-04-16 16:44:55,748 - DEBUG - No retry needed.
2025-04-16 16:44:55,748 - DEBUG - Bedrock response status: 200
2025-04-16 16:44:55,748 - DEBUG - Raw response: {"outputs": [{"text": "Based on the provided code and SonarQube issues, there is no information about the documentation or demo video. The code only shows imports and logging setup in `app/cli.py` and a SonarQube issue related to a default value in `app/core/agents/master_agent.py`. Therefore, I cannot confidently answer if complete and easy-to-follow documentation is included with the solution.\n\nReturn JSON only: `[{\"answer\": \"Cannot determine based on provided code and SonarQube issues.\"...
2025-04-16 16:44:55,749 - DEBUG - NLP raw response for 'Complete and easy-to-follow documentation is inclu...': Based on the provided code and SonarQube issues, there is no information about the documentation or demo video. The code only shows imports and logging setup in `app/cli.py` and a SonarQube issue related to a default value in `app/core/agents/master_agent.py`. Therefore, I cannot confidently answer if complete and easy-to-follow documentation is included with the solution.

Return JSON only: `[{"answer": "Cannot determine based on provided code and SonarQube issues.", "confidence": 1}]`...
2025-04-16 16:44:55,749 - DEBUG - Parsed JSON: [{'answer': 'Cannot determine based on provided code and SonarQube issues.', 'confidence': 1}]
2025-04-16 16:44:55,749 - DEBUG - Generated answer: {'question': 'Complete and easy-to-follow documentation is included with the solution. This includes instructions to setup and run the solution in addition to a demo video.', 'category': 'Presentation (Docs & Demo)', 'answer': 'Cannot determine based on provided code and SonarQube issues.', 'confidence': 1, 'weight': 10.0}
2025-04-16 16:44:55,750 - WARNING - Filtered invalid answer: {'question': 'The solution provides a unique approach to solving the given problem(s).', 'category': 'Innovation & Creativity', 'answer': 'Failed to generate answer', 'confidence': 2, 'weight': 20.0}
2025-04-16 16:44:55,750 - INFO - Processed questions: 3 answers generated
2025-04-16 16:44:55,750 - DEBUG - Scorecard set: 3 valid answers
2025-04-16 16:44:55,750 - INFO - Review completed: {
  "screening_result": {
    "valid": true,
    "reason": null,
    "languages": [
      "Python",
      "JavaScript",
      "HTML"
    ]
  },
  "security_findings": [],
  "quality_metrics": {
    "maintainability_score": 50,
    "code_smells": 2,
    "doc_coverage": 0
  },
  "performance_metrics": {
    "rating": 60,
    "bottlenecks": [],
    "optimization_suggestions": []
  },
  "scorecard": [
    {
      "question": "Requirements are implemented completely according to the requirements with...
2025-04-16 16:44:55,750 - DEBUG - Review result: {
  "screening_result": {
    "valid": true,
    "reason": null,
    "languages": [
      "Python",
      "JavaScript",
      "HTML"
    ]
  },
  "security_findings": [],
  "quality_metrics": {
    "maintainability_score": 50,
    "code_smells": 2,
    "doc_coverage": 0
  },
  "performance_metrics": {
    "rating": 60,
    "bottlenecks": [],
    "optimization_suggestions": []
  },
  "scorecard": [
    {
      "question": "Requirements are implemented completely according to the requirements with...
2025-04-16 16:44:55,763 - INFO - Report generated: report.json
